{% load staticfiles %}

<div class="small-12 columns mixtape top_line_green">
  <div class="row mixtape_header">
    <div class="small-8 columns">
      <div class="small-6 mixtape_info">
        1 free spot &nbsp / &nbsp started {{ tracklist.time_left }} 
      </div>
      <text class="mixtape_title">
        {% if tracklist.title %}
          {{tracklist.title}}
        {% else %}
          #Untitled
        {% endif %}
      </text>
      <ul class="inline-list mixtape_tag_list">
        {% for tag in tracklist.tags.all %}
          <li class="label radius tag_mixtape"> {{tag.name}} </li>
        {% endfor %}
      </ul>
    </div>
    <div class="small-4 columns">
      <div class="row">
        <div class="small-6 columns">
          <button class="button success radius expand play_mxtp_btn"> <img src="{% static "img/round_icon.png" %}"/> Play </button>
        </div>
        <div class="small-6 columns">
          <button class="button expand radius keep_mxtp_btn"> <img src="{% static "img/heart_white_32.png" %}" width="20px" /> Like </button>
        </div>
        <div class="small-6 columns text-center play_mxtp_stats">
          <img src="{% static "img/round_icon.png" %}"/>
          54
        </div>
        <div class="small-6 columns text-center keep_mxtp_stats">
          <img src="{% static "img/heart_white_32.png" %}" width="20px" />
          13
        </div>
      </div>
    </div>
  </div>

  <div class="small-12 columns mixtape_summary">
    <div class="row">
      <div class="small-2 columns mixtape_header_owner">
        <a href="#"><img title="{{tracklist.owner.user.username}}" src="{% static "img/default.jpg" %}" width="82px"/></a>
      </div>
      <div class="small-6 columns mixtape_header_contributors_and_featuring">
        <ul class="inline-list mixtape_header_contributors">
          {% for user_profile in tracklist.userto.all %}
            <li>
              <a href="#"><img title="{{user_profile.user.username}}" src="{% static "img/default.jpg" %}" width="50px"/></a>
            </li>
          {% endfor %}
        </ul>
        <div class="mixtape_featuring">
          {% if tracklist.bundlebacks.all %}
            featuring&nbsp;
            {% for bundleback in tracklist.bundlebacks.all %}
              {% for track in bundleback.tracks.all %}
                {% if track.artist and forloop.counter == 1 and forloop.parentloop.counter < 4 %}
                  {% if forloop.parentloop.counter == 3 %}
                    {{ track.artist }} ...
                  {% else %}
                    {{ track.artist }},&nbsp;
                  {% endif %}
                {% endif %}
              {% endfor %}
            {% endfor %}
          {% endif %}
        </div>
      </div>
      <div class="small-4 columns display_tracks_btn_zone">
        <button class="button expand radius display_tracks_btn"> Show tracks </button>
      </div>
      <div class="small-8 columns show_add_track_form_btn_zone">

{% comment %} A enlever quand la suite est ajout√©e ! {% endcomment %}

        <button class="button expand radius show_add_track_form_btn"> Add a track </button>

{% comment %} A rajouter !

        {# If mixtape over (> 72h) #}
          <button class="button expand radius disabled cannot_show_add_track_form_btn"> Mixtape over - no tracks can be added </button>
        {# Else if <72h #}
          {# If exterior #}
            {# If spots left #}
              <button class="button expand radius show_add_track_form_btn"> Jump in and add a track </button>
            {# Else #}
              <button class="button expand radius disabled cannot_show_add_track_form_btn"> Mixtape full - you can't contribute </button>
            {# Endif #}
          {# If called (or already jumped in and added one track) #}
            {# If added no track yet #}
              <button class="button expand radius show_add_track_form_btn"> You were called - add your first track </button>
            {# Elif added 1 track already #}
              <button class="button expand radius show_add_track_form_btn"> Add another track </button>
            {# Elif added 2 tracks already #}
              <button class="button expand radius show_add_track_form_btn"> Add one last track </button>
            {# Else (3 tracks) #}
              <button class="button expand radius disabled cannot_show_add_track_form_btn"> You've already added 3 tracks </button>
            {# Endif #}
          {# Else (if owner) #}
            {# If added no track yet #}
              <button class="button expand radius show_add_track_form_btn"> Add a track to your mixtape </button>
            {# Elif added 1 track already #}
              <button class="button expand radius show_add_track_form_btn"> Add another track </button>
            {# Elif added 2 tracks already #}
              <button class="button expand radius show_add_track_form_btn"> Add one last track </button>
            {# Else (3 tracks) #}
              <button class="button expand radius disabled cannot_show_add_track_form_btn"> You've already added 3 tracks </button>
            {# Endif #}
          {# Endif #}
        {# Endif #}

{% endcomment %}

      </div>
      <div class="small-4 columns hide_tracks_btn_zone">
        <button class="button expand radius secondary hide_tracks_btn"> Hide tracks </button>
      </div>
      <div class="small-4 columns mixtape_add_track_info">
        /// info
      </div>
      <div class="small-8 columns mixtape_add_track_form_zone">
        <form action="/mixtape/{{tracklist.id}}/add/track/" class="mixtape_add_track_form" method="post">
          {% csrf_token %}
          <div class="row">
            <div class="small-10 columns">
              <div class="row collapse">
                <div class="small-2 columns">
                  <span class="prefix">http://</span>
                </div>
                <div class="small-10 columns">
                  <input type="text" name="url" placeholder="Track URL" id="input_url"/>
                </div>
              </div>
            </div>
            <div class="small-2 columns">
              <input type="submit" class="button postfix expand mixtape_add_track_btn" value="Add"/>
            </div>
          </div>
          <div class="row ">
            <div class="small-5 columns ">
              <input type="text" name="artist" placeholder="Artist (optional)"/>
            </div>
            <div class="small-5 columns">
              <input type="text" name="name" placeholder="Name (optional)"/>
            </div>
            <div class="small-2 columns">
              <input type="button" value="X" class="button postfix secondary expand mixtape_add_track_cancel" />
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>

  <ul class="no-bullet bundle_list">
    {% if tracklist.tracks_initial %}
      <li>
        <div class="small-12 columns mixtape_bundle">
          <div class="row collapse">
            <div class="small-4 columns bundle_profile">
              {% include "hip_engine/snippet_mini_profile_mixtape_owner.html" %}
            </div>
            <div class="small-8 columns
              {% if tracklist.tracks_initial.all|length_is:"0" %} bundle_tracklist_0 {% endif %}
              {% if tracklist.tracks_initial.all|length_is:"1" %} bundle_tracklist_1 {% endif %}
              {% if tracklist.tracks_initial.all|length_is:"2" %} bundle_tracklist_2 {% endif %}
              {% if tracklist.tracks_initial.all|length_is:"3" %} bundle_tracklist_3 {% endif %}">
              <ul class="no-bullet">
                {% for track in tracklist.tracks_initial.all %}
                  <li>
                    {% include "hip_engine/snippet_track.html" %}
                  </li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
      </li>
    {% endif %}
    {% for bundle in tracklist.bundlebacks.all %}
      <li>
        <div class="small-12 columns mixtape_bundle ">
          <div class="row collapse">
            <div class="small-4 columns bundle_profile">
              {% include "hip_engine/snippet_mini_profile_mixtape_bundler.html" %}
            </div>
            <div class="small-8 columns 
              {% if bundle.tracks.all|length_is:"0" %} bundle_tracklist_0 {% endif %}
              {% if bundle.tracks.all|length_is:"1" %} bundle_tracklist_1 {% endif %}
              {% if bundle.tracks.all|length_is:"2" %} bundle_tracklist_2 {% endif %}
              {% if bundle.tracks.all|length_is:"3" %} bundle_tracklist_3 {% endif %}">
              <ul class="no-bullet">
                {% for track in bundle.tracks.all %}
                  <li>
                    {% include "hip_engine/snippet_track.html" %}
                  </li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
      </li>
    {% endfor %}
    {% if request.user.get_profile == tracklist.owner %}
      <li>
        <div class="small-12 columns close_mixtape_zone">
          <form action="" class="" method="post">
            <button class="button expand success close_mixtape_btn"> Close mixtape </button>
          </form>
        </div>
      </li>
    {% endif %}
  </ul>

</div>


